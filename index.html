<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Formalising modular forms and sphere packings in Lean</title>

        <meta name="description" content="Formalising modular forms and sphere packings in Lean.">
        <meta name="author" content="Chris Birkbeck">

        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="dist/reset.css">
        <link rel="stylesheet" href="dist/reveal.css">
        <link rel="stylesheet" href="dist/theme/black.css" id="theme">

        <link rel="stylesheet" href="plugin/highlight/monokai.css">
        <style>
        pre code {
            font-size: 0.7em; /* Change 80% to whatever width you prefer */
        }
        .r-stack {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        </style>
         <script type="module">
            import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@9/dist/mermaid.esm.min.js';
            mermaid.initialize({
                startOnLoad: true,
                theme: 'base',
                themeVariables: {
                    primaryColor: 'rgba(255, 255, 255, 0.050)',
                    primaryTextColor: '#fff',
                    primaryBorderColor: 'rgba(255, 255, 255, 0.18)',
                    boxShadow: '0 8px 12px rgba(0,0,0,0.1)',
                    nodeBorderRadius: '15px',
                    padding: '20px',
                    margin: '10px',
                    minWidth: '400px',
                    backdropFilter: 'blur(20px)',
                    webkitBackdropFilter: 'blur(20px)',
                    fontWeight: 'bold',
                    textAlign: 'center',
                    lineHeight: '2'
                }
            });
        </script>
        <style>
        .reveal .slides {
            width: 100%; /* Adjust this value as needed */
            height: auto; /* Keeps the height adaptable */
        }
        </style>
        <style>
        /* Custom CSS for theorem and definition */
        .reveal .theorem, .reveal .definition {
            margin: 2em 0;
            padding: 1em 1em;
            border-left: 5px solid #3498db;
            border-right: 5px solid #3498db;
            background-color: #2c3e50; /* Dark grey background */

        }


        .reveal .theorem p:first-child, .reveal .definition p:first-child {
            margin-top: 0;
        }

        .reveal .theorem p:last-child, .reveal .definition p:last-child {
            margin-bottom: 0;
        }
        </style>
        <script>
            document.addEventListener("DOMContentLoaded", event => {
              // we can move only if we are not in a browser's tab
              isBrowser = matchMedia("(display-mode: browser)").matches;
              if (!isBrowser) {
                  window.resizeTo(1024, 768);
              }
            });
          </script>
        <style>
        .bento-box {
          display: flex;
          justify-content: space-around;
          flex-wrap: wrap;
          margin-top: 20px;
        }

        .bento-box .box {
          flex: 1;
          margin: 10px;
          padding: 20px;
          background-color:#2c3e50; /* Light grey background */
          border-radius: 15px; /* Rounded corners */
          box-shadow: 0 4px 6px rgba(0,0,0,0.1); /* Soft shadow */
          min-width: 250px; /* Minimum width of boxes */
          text-align: center; /* Center text */
        }

        .box .inner-box {
            background-color: #e0e0e0; /* Slightly different background to distinguish */
            margin-bottom: 10px; /* Space between the two inner boxes */
            padding: 10px;
            border-radius: 10px; /* Optional: rounded corners for inner boxes */
            }

            /* Last inner-box should not have a margin at the bottom */
            .box .inner-box:last-child {
            margin-bottom: 0;
            }
        </style>
    </head>

    <body>

        <div class="reveal" >

            <div class="slides">
                <section data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <h2>
                        <span style="text-transform: none;">Formalising modular forms and sphere packings in</span>
                        <span style="text-transform: none; color: #000000">Lean</span>
                    </h2>
                    <p>
                        <small>Chris Birkbeck</small>
                    </p>
                    <p>
                        <small>University of East Anglia</small>
                    </p>
                    <small>
                        slides: <a style="color: #000000;" href="https://cbirkbeck.github.io/BMC/">
                        cbirkbeck.github.io/BMC/</a>
                    </small>
                    <div style="text-align: center;">
						<img src="QR.png" alt="QR Code" style="width: 100px; height: 100px;">
					</div>
                    <div style="text-align: center;">
                        </div>
                    <small style="display: block; text-align: center; opacity: 0.5">2025-06-24</small>
                </section>


                <section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <textarea data-template>
                        ### <span style="text-transform: none;">Today's Talk</span>
                        - I'll discuss the ongoing project to formalise <span style="text-transform: none; color: #000000">Maryna Viazovska's</span> Fields Medal work on the sphere packing problem in 8 dimensions.
                        ---
                        ### <span style="text-transform: none;">Today's Talk</span>
                        - I'll discuss the ongoing project to formalise <span style="text-transform: none; color: #000000">Maryna Viazovska's</span> Fields Medal work on the sphere packing problem in 8 dimensions.
                        - In particular I'll focus on formalising the required <span style="text-transform: none; color: #000000">modular form</span> background theory.
                        ---
                        ### <span style="text-transform: none;">The Sphere Packing project</span>
                        This is joint work with:
                        <div style="display: flex; justify-content: center; gap: 80px; font-size: 0.9em;">
                            <ul style="margin: 0;">
                                <li>Sidharth Hariharan</li>
                                <li>Seewoo Lee</li>
                                <li>Gareth Ma</li>
                            </ul>
                            <ul style="margin: 0;">
                                <li>Bhavik Mehta</li>
                                <li>Maryna Viazovska</li>
                            </ul>
                        </div>
                        <br>
                        <p style="font-size: 0.8em;">With lots of extra help from Kevin Buzzard and David Loeffler and the Lean community.</p>
                        ---
                        ### <span style="text-transform: none;">What is Lean</span>
                        - It's an interactive theorem prover.
                        ---
                         ### <span style="text-transform: none;">What is Lean</span>
                        - It's a specialised programming language for writing and verifying proofs, a process known as <span style="text-transform: none; color: #000000">formalisation</span>. 
                        ---
                         ### <span style="text-transform: none;">Why formalise?</span>
                        ---
                        ### <span style="text-transform: none;">Why formalise these things?</span>
                        - To test and expand our libraries of formal maths (such as the <span style="text-transform: none; color: #000000">mathlib</span> library) as well as formalising current research.
                        ---
                         ### <span style="text-transform: none;">Why formalise these things?</span>
                        - To test and expand our libraries of formal maths (such as the <span style="text-transform: none; color: #000000">mathlib</span> library) as well as formalising current research.
                        - Maybe someday AI will be able to help us prove new theorems.
                        ---
                        ### <span style="text-transform: none;">Why formalise these things?</span>
                        - To test and expand our libraries of formal maths (such as the <span style="text-transform: none; color: #000000">mathlib</span> library) as well as formalising current research.
                        - Maybe someday AI will be able to help us prove new theorems.
                        - It's fun!
                    </textarea>
                </section>

                <section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <textarea data-template>
                        ### <span style="text-transform: none;">The Sphere Packing Problem</span>
                        <div class="definition">
                        <strong>Problem</strong>: What is the densest possible arrangement of identical, non-overlapping spheres in a given space?
                        </div>
                        ---
                      ### <span style="text-transform: none;">The Sphere Packing Problem</span>
                        Here by densest we mean: the arrangement that maximises the ratio of the volume occupied by the spheres to the total volume of the space. 
                        ---
                        ### <span style="text-transform: none;">The Sphere Packing Problem</span> 
                        Specifically, we want to find: <br>$\Delta_n = \sup_{\text{Packing}} \limsup_{r \to \infty} \frac{\text{Packing} \cap B_n(0,r)}{B_n(0,r)}$.  
                 </textarea>
                </section>

                <section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <textarea data-template>
                        ### <span style="text-transform: none;">A Simple Case: Dimension 1</span>
                        - In one dimension, "spheres" are line segments of equal length.
                        ---
                        ### <span style="text-transform: none;">A Simple Case: Dimension 1</span>
                        - In one dimension, "spheres" are line segments of equal length.
                        - The densest packing is achieved by placing them end-to-end, leaving no gaps.
                        ---
                        ### <span style="text-transform: none;">A Simple Case: Dimension 1</span>
                        - In one dimension, "spheres" are line segments of equal length.
                        - The densest packing is achieved by placing them end-to-end, leaving no gaps.
                     
                        ---
                        ### <span style="text-transform: none;">A Simple Case: Dimension 1</span>
                        The packing density is exactly **1**.
                        <br>
                        <img src="dim1.png" alt="1D Packing" style="border-radius: 10px; background-color: white; width: 400px;">
                        ---
                        ### <span style="text-transform: none;">The Plane: Dimension 2</span>
                        - In two dimensions, we are packing circles.
                        ---
                        ### <span style="text-transform: none;">The Plane: Dimension 2</span>
                        - In two dimensions, we are packing circles.
                        - The optimal solution is the <span style="text-transform: none; color: #000000">hexagonal lattice packing</span>, where each circle touches six others.
                        ---
                        ### <span style="text-transform: none;">The Plane: Dimension 2</span>
                        <img src="dim2.png" alt="2D Packing" style="float: right; border-radius: 10px; background-color: white; width: 250px; margin-left: 20px;">
                     
                        <br>
                        <br>
                          This was proven by Lagrange in 1773. The density is $\frac{\pi}{\sqrt{12}} \approx 0.9069$.
                        <br>
                        <br>
                        <br>
                        ---
                   ### <span style="text-transform: none;">The Kepler Conjecture (Dimension 3)</span>
                        <img src="cannon2.png" alt="2D Packing" style="float: right; border-radius: 10px; background-color: white; width: 250px; margin-left: 20px;">
                       
                        <br>
                        <br>
                         The most famous instance of the problem is probably in 3D. Where apparently, Sir Walter Raleigh asked 
                            Thomas Harriot how to pack cannonballs in a ship.
                        <br>
                        <br>
                        <br>
                        ---
                        ### <span style="text-transform: none;">The Kepler Conjecture (Dimension 3)</span>
                         In 1611, Johannes Kepler conjectured that the highest density is achieved by the "pyramid stacking" seen in piles of oranges or cannonballs.    
                        ---
                        ### <span style="text-transform: none;">The Kepler Conjecture (Dimension 3)</span>
                        <img src="dim3.png" alt="2D Packing" style="float: right; border-radius: 10px; background-color: white; width: 250px; margin-left: 20px;">
                       
                        <br>
                        <br>
                         This arrangement has a density of $\frac{\pi}{\sqrt{18}} \approx 0.74$.
                        <br>
                        <br>
                        <br>
                        ---
                        ### <span style="text-transform: none;">Hales' Proof and Formalisation</span>
                        - In 1998, <span style="text-transform: none; color: #000000">Thomas Hales</span> announced a proof using a massive computer-assisted search to check a huge number of cases.
                        ---
                        ### <span style="text-transform: none;">Hales' Proof and Formalisation</span>
                        - In 1998, <span style="text-transform: none; color: #000000">Thomas Hales</span> announced a proof using a massive computer-assisted search to check a huge number of cases.
                        - Annals said they were 99% sure it was correct, so the proof underwent a major formal verification effort: the <span style="text-transform: none; color: #000000">Flyspeck project</span>.
                        ---
                        ### <span style="text-transform: none;">Hales' Proof and Formalisation</span>
                        - Annals said they were 99% sure it was correct, so the proof underwent a major formal verification effort: the <span style="text-transform: none; color: #000000">Flyspeck project</span>.
                        - The formal proof, completed in 2014 using the HOL Light theorem prover, was published in 2017.
                        ---
                        ### <span style="text-transform: none;">The Problem in 8 Dimensions</span>
                        <div class="theorem">
                        <strong>Theorem (Viazovska, 2016)</strong>:
                        No packing of unit spheres in Euclidean space $\mathbb{R}^{8}$ has a density greater than that of the $E_8$-lattice packing.
                        </div>
          
                        ---
                      
                     
                          ### <span style="text-transform: none; color: #000000">E8</span>
                        <img src="e8root.png" alt="2D Packing" style="float: right; border-radius: 10px; width: 250px; margin-left: 20px;">
                       
                    
                        <br>
                         By $E_8$-lattice packing, we mean put a sphere at every point* in the $E_8$ lattice, which is defined as: $$ \{ (x_i) \in (\mathbb{Z}^8 \cup (\mathbb{Z} + \frac{1}{2})^8) | \sum_i x_i \equiv 0 \pmod 2\}$$
                        <br>
                        <br>
                        <br>
                        ---
                        ###  <span style="text-transform: none; color: #000000">E8</span>
                       
                        <pre><code data-trim data-noescape class="language-lean hljs">
                        -- E‚Çà is characterised as the set of vectors with (1) coordinates summing to an even integer,
                        -- and (2) all its coordinates either an integer or all a half-integer. 
                        def E8_Set : Set (EuclideanSpace ‚Ñù (Fin 8)) :=
                        {v | ((‚àÄ i, ‚àÉ n : ‚Ñ§, n = v i) ‚à® (‚àÄ i, ‚àÉ n : ‚Ñ§, Odd n ‚àß n = 2 * v i)) ‚àß ‚àë i, v i ‚â° 0 [PMOD 2]}
                    </code></pre>
                  
                        ---
                           ### <span style="text-transform: none;">The Problem in 8 Dimensions</span>
                
                        This has a packing density of $\frac{\pi^4}{384} \approx 0.25367$. The hard bit is proving you can't do better. 
                        ---
                              ### <span style="text-transform: none;">The Problem in 24 Dimensions</span>
                
                        Shortly after this, Viazovska together with Cohn, Kumar, Miller and Radchenko announced a proof in dimension 24. Here the density is $\frac{\pi^{12}}{12!} \approx 0.00193$.
                        ---
                        ### <span style="text-transform: none;">The formal statement in Lean</span>
                         <pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-3|5-9|11-16|18-19|21-22|24" >
                           /-- The `SpherePackingConstant` in dimension d is the supremum of the density of all packings. -/
                            def SpherePackingConstant (d : ‚Ñï) : ‚Ñù‚â•0‚àû :=
                            ‚®Ü S : SpherePacking d, S.density

                            structure SpherePacking (d : ‚Ñï) where
                            centers : Set (EuclideanSpace ‚Ñù (Fin d))
                            separation : ‚Ñù
                            separation_pos : 0 < separation := by positivity
                            centers_dist : Pairwise (separation ‚â§ dist ¬∑ ¬∑ : centers ‚Üí centers ‚Üí Prop)
                            
                            noncomputable def E8Packing : PeriodicSpherePacking 8 where
                            separation := ‚àö2
                            lattice := E8_Lattice
                            centers := E8_Lattice
                            centers_dist x y h := (E8_norm_lower_bound (x - y)).resolve_left <| sub_ne_zero_of_ne h
                            lattice_action x y := add_mem

                            noncomputable def SpherePacking.finiteDensity (S : SpherePacking d) (R : ‚Ñù) : ‚Ñù‚â•0‚àû :=
                            volume (S.balls ‚à© ball 0 R) / (volume (ball (0 : EuclideanSpace ‚Ñù (Fin d)) R))

                            noncomputable def SpherePacking.density (S : SpherePacking d) : ‚Ñù‚â•0‚àû :=
                            limsup S.finiteDensity atTop
                           
                            theorem SpherePacking.MainTheorem : SpherePackingConstant 8 = E8Packing.density := by sorry
                         </code></pre>    
                        ---
                          ### <span style="text-transform: none;">Proof outline</span>
                        The proof uses a clever combination of linear programming, complex analysis, and modular forms.

                    </textarea>
                </section>


                <section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <textarea data-template>
                        ### <span style="text-transform: none;">The Cohn-Elkies Bound</span>
                        - Proving a packing is optimal is incredibly hard. You have to rule out every other possible configuration.
                        ---
                        ### <span style="text-transform: none;">The Cohn-Elkies Bound</span>
                        - Proving a packing is optimal is incredibly hard. You have to rule out every other possible configuration.
                        - The <span style="text-transform: none; color: #000000">Cohn-Elkies linear programming bound</span> provides a powerful shortcut.
                        ---
                        ### <span style="text-transform: none;">The Cohn-Elkies Bound</span>
                        - Proving a packing is optimal is incredibly hard. You have to rule out every other possible configuration.
                        - The <span style="text-transform: none; color: #000000">Cohn-Elkies linear programming bound</span> provides a powerful shortcut.
                        - It reduces the problem to finding a single, special function.
                        ---
                       
          
                        <strong>Theorem (Cohn-Elkies)</strong>:
                        The density of any sphere packing is bounded by <span style="text-transform: none; color: #000000">$\frac{f(0)}{\hat{f}(0)}\mathrm{Vol} (B_8(0,1/2))$</span> if a non-zero Schwartz function $f : \mathbb{R}^8 \to \mathbb{R}$ exists such that:
                        <ol>
                            <li>$f(x) \le 0$ for $||x|| \ge 1$</li>
                            <li>Its Fourier transform $\hat{f}(y) \ge 0$ for all $y$.</li>
                        </ol>
            
                        ---
                        ### <span style="text-transform: none;">The "Magic" Function</span>
                        Viazovska's proof hinges on constructing a "magic" radial Schwartz function <span style="text-transform: none; color: #000000">$g$</span> for dimension 8,  with the properties:
                        <ol>
                            <li>$g(x) \le 0$ for $||x|| \ge \sqrt{2}$</li>
                            <li>$\hat{g}(x) \ge 0$ for all $x \in \mathbb{R}^8$</li>
                            <li>$g(0) = \hat{g}(0) = 1$</li>
                        </ol>
                        ---
              
                        This magic function is of the form $$g(r) = \sin(\pi r^2/2)^2 \int_{0}^{\infty} \varphi(it) e^{-\pi r^2 t} dt$$ where $\varphi$ is a holomorphic function on the upper half-plane.
                        ---
                        ### <span style="text-transform: none;">Modular form input</span>
                         - If you unpack the definition of this $\varphi$ you find it's constructed from sums and quotients of Theta series, Eisenstein series, the Ramanujan delta function.
                        ---
                        ### <span style="text-transform: none;">Modular form input</span>
                         - If you unpack the definition of this $\varphi$ you find it's constructed from sums and quotients of Theta series, Eisenstein series, the Ramanujan delta function.
                         - To prove it satisfies the Cohn-Elkies criteria, you also need to prove several identities between quasimodular forms and modular forms.
                       
                        
                    </textarea>
                </section>

                <section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <textarea data-template>
                        ### <span style="text-transform: none;">Modular Forms in Lean</span>
                       
                        A modular form of weight $k$ and level $\Gamma \subset SL_2(\mathbb{Z})$ is a holomorphic function $f: \mathbb{H} \to \mathbb{C}$ on the upper half-plane such that: 
                        
           
                        - Satisfies the transformation law: <br>
                         $(cz+d)^{-k}f\left(\frac{az+b}{cz+d}\right) =  f(z)$ for all $\( \begin{smallmatrix} a & b \\\\ c & d \end{smallmatrix}\) \in \Gamma$.
                        - Is "well-behaved" at the cusps.
                       
                       
                        ---
                         ### <span style="text-transform: none;">Modular Forms in Lean</span>
                       
                        A modular form of weight $k$ and level $\Gamma \subset SL_2(\mathbb{Z})$ is a holomorphic function $f: \mathbb{H} \to \mathbb{C}$ on the upper half-plane such that: 
                        
           
                        - Satisfies the transformation law:<br>
                         $(f\mid_k \gamma) (z) =  f(z)$ for all $\gamma \in \Gamma$.
                        - Is "well-behaved" at the cusps.
                       
                       
                        ---
                         ### <span style="text-transform: none;">Modular Forms in Lean</span>
                       
                        A  <span style="text-transform: none; color: #000000">cusp form</span>  of weight $k$ and level $\Gamma \subset SL_2(\mathbb{Z})$ is a holomorphic function $f: \mathbb{H} \to \mathbb{C}$ on the upper half-plane such that: 
                        
           
                        - Satisfies the transformation law:<br>
                         $(f\mid_k \gamma) (z) =  f(z)$ for all $\gamma \in \Gamma$.
                        - Is <span style="text-transform: none; color: #000000">zero</span>  at the cusps.
                       
                       
                        ---
                        ### <span style="text-transform: none;">Modular Forms in Lean</span>
                        <pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-4|6-10|12-16" >
                            -- Functions `‚Ñç ‚Üí ‚ÑÇ` that are invariant under the `SlashAction`. 
                            structure SlashInvariantForm where
                            toFun : ‚Ñç ‚Üí ‚ÑÇ
                            slash_action_eq' : ‚àÄ Œ≥ ‚àà Œì, toFun ‚à£[k] Œ≥ = toFun --Invariance under the slash action
    
                            -- These are `SlashInvariantForm`'s that are holomorphic and bounded at infinity.
                            structure ModularForm extends SlashInvariantForm Œì k where
                            holo' : MDifferentiable ùìò(‚ÑÇ) ùìò(‚ÑÇ) (toSlashInvariantForm : ‚Ñç ‚Üí ‚ÑÇ) -holomorphic
                            bdd_at_infty' : ‚àÄ A : SL(2, ‚Ñ§), IsBoundedAtImInfty (toSlashInvariantForm ‚à£[k] A) -well-behaved at cusps

                            -- These are `SlashInvariantForm`s that are holomorphic and zero at infinity. 
                            structure CuspForm extends SlashInvariantForm Œì k where
                            holo' : MDifferentiable ùìò(‚ÑÇ) ùìò(‚ÑÇ) (toSlashInvariantForm : ‚Ñç ‚Üí ‚ÑÇ)
                            zero_at_infty' : ‚àÄ A : SL(2, ‚Ñ§), IsZeroAtImInfty (toSlashInvariantForm ‚à£[k] A)

                        </code></pre>
                        
                    </textarea>
                </section>

              

                <section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <textarea data-template>
                        ### <span style="text-transform: none;">Main modular form input</span>
                         One key input is the dimension formula for modular forms of weight $k$ for the group $\mathrm{SL}_2(\mathbb{Z})$, which says: 
                        $$ \dim M_k = \begin{cases} \lfloor k/12 \rfloor & \text{if } k \equiv 2 \pmod{12} \\\\ \lfloor k/12 \rfloor + 1 & \text{otherwise} \end{cases} $$
                        ---
                        ### <span style="text-transform: none;">Key Examples</span>
                        The first example you normally see are <span style="text-transform: none; color: #000000">Eisenstein series</span> <br>
                        $E_k(z) = \frac{1}{\zeta(k)} \sum_{(m,n) \in \mathbb{Z}^2\} \frac{1}{(mz+n)^k}$ for $k \ge 3$.
                       
                        ---
                         ### <span style="text-transform: none;">Key Examples</span>
                        The first example you normally see are <span style="text-transform: none; color: #000000">Eisenstein series</span> <br>
                        $E_k(z) = 1 + \frac{(2 \pi i)^k}{\zeta(k)}\sum_{n > 0} \sigma_{k-1}(n) q^n$ <br> for $k \ge 3$ and even with $q = e^{2\pi i z}$ and <br>$\sigma_k(n) = \sum_{d | n} d^k$.
                       
                        ---
                         ### <span style="text-transform: none;">Key Examples</span>
                        The first cusp form you see is the <span style="text-transform: none; color: #000000">Ramanujan delta function</span> <br>
                        $\Delta(z) = q \prod_{n=1}^\infty (1-q^n)^{24} $ where $q = e^{2\pi i z}$.
                       
                        ---
                        ###  <span style="text-transform: none;">The Quasimodular Form $E_2$</span>
                        - For weight 2, the Eisenstein series definition does not yield a modular form.
                        - We define <span style="text-transform: none; color: #000000">$E_2$</span> as: <br>$E_2(z) := \frac{1}{2\zeta(2)} \sum_{n : \mathbb{Z}} \sum_{m : \mathbb{Z}} \frac{1}{(mz+n)^2}$.
                        ---
                         ###  <span style="text-transform: none;">The Quasimodular Form $E_2$</span>
                        - Its q-expansion is: <br>$E_2(z) := 1 - 24\sum_{n=1}^\infty \sigma_1(n)q^n$.
                        - It's not quite a modular form, its a <span style="text-transform: none; color: #000000">quasimodular form</span>.
                        ---
                          ###  <span style="text-transform: none;">The Quasimodular Form $E_2$</span>
                        - It's not quite a modular form, its a <span style="text-transform: none; color: #000000">quasimodular form</span>.
                        - You can check that :<br> $(E_2 \mid_k \gamma) (z)= E_2(z) - \frac{2 \pi i c} {c z + d} $ for $\gamma = \(\begin{smallmatrix} a & b \\\\ c & d \end{smallmatrix}\)$.
                        
                        ---
                          ###  <span style="text-transform: none;">The Quasimodular Form $E_2$</span>
                        The key is show that:

                        <div data-id="equation-container" style="display: flex; align-items: center; justify-content: center;">
                            <div data-id="sum-part">$$ \sum_{m \ne 0} \sum_{n \in \mathbb{Z}} $$</div>
                            <div data-id="fraction-part">$$ \left( \frac{1}{mz+n} - \frac{1}{mz+n+1} \right) = $$</div>
                            <div data-id="rhs-part">$$ 0 $$</div>
                        </div>

                        ---
                        ###  <span style="text-transform: none;">The Quasimodular Form $E_2$</span>
                        The key is show that:
                      

                        <div data-id="equation-container" style="display: flex; align-items: center; justify-content: center;">
                            <div data-id="sum-part">$$ \sum_{n \in \mathbb{Z}} \sum_{m \ne 0} $$</div>
                            <div data-id="fraction-part">$$ \left( \frac{1}{mz+n} - \frac{1}{mz+n+1} \right) = $$</div>
                            <div data-id="rhs-part">$$ \textcolor{#000000}{-\frac{2 \pi i}{z}} $$</div>
                        </div>
                        
                        ---
                        ###  <span style="text-transform: none;">The Quasimodular Form $E_2$</span>
                        In Lean:
                        <pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-3|5-7" >
                            lemma Sum1 (z : ‚Ñç) : ‚àë' m : ‚Ñ§, (limUnder atTop fun N : ‚Ñï => 
                            ‚àë n ‚àà Finset.Ico (-(N : ‚Ñ§)) (N : ‚Ñ§), 
                                (1 / ((m : ‚ÑÇ) * z + n) -  1 / (m * z + n + 1))) = 0 := by ...

                            lemma Sum2 (z : ‚Ñç) : limUnder atTop
                            (fun N : ‚Ñï => ‚àë n ‚àà Finset.Ico (-(N : ‚Ñ§)) (N : ‚Ñ§),
                            ‚àë' m : ‚Ñ§ , (1 / ((m : ‚ÑÇ) * z + n) -  1 / (m * z + n + 1))) = -2 * œÄ * Complex.I / z := by ...
                         </code></pre>        
                        ---
                        
                        ### <span style="text-transform: none;">The Serre Derivative</span>
                        - $E_2$ is useful for defining the <span style="text-transform: none; color: #000000">Serre derivative</span>:
                        $$ \partial_k f := \frac{1}{2\pi i}f' - \frac{k}{12}E_2 f $$
                        -  if $f$ is a modular form of weight $k$, then $\partial_k f$ is a modular form of weight $k+2$.
                        ---
                        This is useful for us, since we need to prove things like:
                        $$
                        \begin{align*}
                        \partial_{1}E_2 &= -\frac{1}{12} E_4  \\\\
                        \partial_{4}E_4 &= -\frac{1}{3} E_6  \\\\
                        \partial_{6}E_6 &= -\frac{1}{2} E_4^2 
                        \end{align*}
                        $$
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>
                        - Normally, to prove the dimension formula, you might want to use the valence formula.
                        - The problem is that it crucially depends on integrating your modular form over a fundamental domain, which is not easy to do in Lean.
                        ---
                        ### <span style="text-transform: none; color: #000000">Valence formula contour</span>
                        <img src="valcont.png" alt="contour" style="float: right; border-radius: 10px; width: 250px; margin-left: 20px;">
                       
                    
                        <br>
                        The problem is that it crucally depends on integrating your modular form over a fundamental domain, which is not easy to do in Lean.
                        <br>
                        <br>
                        <br>
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>
                        Instead we use $E_2$.
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>
                        - First, one can prove that there are no non-zero modular forms of negative weight and in weight $0$ you only have the constant functions.
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        To do this, one uses (a consequence of) the <span style="text-transform: none; color: #000000"> maximum modulus principle</span>: If $f$ is a function differentiable on the open unit ball, and there exists an $r < 1$ such that
                            for any value of $‚Äñf‚Äñ$ on the open ball we can bound it above by some value on the closed ball of radius $r$, then $f$ is constant.
                        ---
                        ### <span style="text-transform: none;">In Lean</span>
                        <pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-5" >
                                        -- The maximum modulus principle
                                        lemma eq_const_of_exists_le [ProperSpace E] {f : E ‚Üí F} {r b : ‚Ñù}
                    (h_an : DifferentiableOn ‚ÑÇ f (ball 0 b)) (hr_nn : 0 ‚â§ r) (hr_lt : r < b)
                    (hr : ‚àÄ z, z ‚àà (ball 0 b) ‚Üí ‚àÉ w, w ‚àà closedBall 0 r ‚àß ‚Äñf z‚Äñ ‚â§ ‚Äñf w‚Äñ) : 
                    Set.EqOn f (Function.const E (f 0)) (ball 0 b) := by ...
                    </code></pre>
                        ---



                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        - With this in hand, it's then enough to construct $\Delta$, since this is a weight 12 cusp form, which doesn't vanish on the upper half-plane. 
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        - With this in hand, it's then enough to construct $\Delta$, since this is a weight 12 cusp form, which doesn't vanish on the upper half-plane. 
                        - $M_k \to S_{k+12}$ given by $f \mapsto f \cdot \Delta$ is an isomorphism of vector spaces.
                        ---
                         ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        - Problem: How do we prove that $\Delta$ is even a modular form? 
                        - Could define it as $\frac{E_4^3 - E_6^2}{1728}$, but then how do you prove it doesn't vanish on the upper half-plane?
                        ---
                         ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        - Problem: How do we prove that $\Delta$ is even a modular form? 
                        - Key is to use $E_2$.
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        - Problem: How do we prove that $\Delta$ is even a modular form? 
                        - Since $\mathrm{SL}_2(\mathbb{Z})$ is generated by the matrices $\(\begin{smallmatrix} 1 & 1 \\\\ 0 & 1 \end{smallmatrix}\)$ and $\(\begin{smallmatrix} 0 & -1 \\\\ 1 & 0 \end{smallmatrix}\)$, it suffices to show that $\Delta$ is invariant under these transformations.
                        
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        - Since $\mathrm{SL}_2(\mathbb{Z})$ is generated by the matrices $\(\begin{smallmatrix} 1 & 1 \\\\ 0 & 1 \end{smallmatrix}\)$ and $\(\begin{smallmatrix} 0 & -1 \\\\ 1 & 0 \end{smallmatrix}\)$, it suffices to show that $\Delta$ is invariant under these transformations.
                        - The hard one is the second one, since it sends $z \mapsto -1/z$. 
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        - The hard one is the second one, since it sends $z \mapsto -1/z$. 
                        - If $\eta = \Delta ^ {1/24}$, then one can show that the logarithmic derivative $\frac{\eta'}{\eta}$ is equal to $\frac{\pi i}{12} E_2$.
                        ---
                        ### <span style="text-transform: none;">Proving the Dimension Formula</span>  
                        - If $\eta = \Delta ^ {1/24}$, then one can show that the logarithmic derivative $\frac{\eta'}{\eta}$ is equal to $\frac{\pi i}{12} E_2$.
                        - Then using the transformation law for $E_2$, you get $\eta(\frac{-1}{z}) = \sqrt{iz}\eta(z)$
                    </textarea>
                </section>
                
                <section data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <h4><span style="text-transform: none;">Lean code</span></h4>
                    <pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-2|4|6|8-9|11-12|14-15|17|19|21-23" >
                       def G‚ÇÇ : ‚Ñç ‚Üí ‚ÑÇ := fun z => limUnder (atTop)
                        (fun N : ‚Ñï => ‚àë m ‚àà Finset.Ico (-N : ‚Ñ§) N, (‚àë' (n : ‚Ñ§), (1 / ((m : ‚ÑÇ) * z + n) ^ 2)))

                       def E‚ÇÇ : ‚Ñç ‚Üí ‚ÑÇ := (1 / (2 * riemannZeta 2)) ‚Ä¢  G‚ÇÇ

                       def D‚ÇÇ (Œ≥ : SL(2, ‚Ñ§)) : ‚Ñç ‚Üí ‚ÑÇ := fun z => (2 * œÄ * Complex.I * Œ≥ 1 0) / (denom Œ≥ z)

                       /-This is the annoying exercise. -/
                       lemma G‚ÇÇ_transform (Œ≥ : SL(2, ‚Ñ§)) : (G‚ÇÇ ‚à£[(2 : ‚Ñ§)] Œ≥) = G‚ÇÇ - (D‚ÇÇ Œ≥) := by
                       
                       def Œ∑ (z : ‚ÑÇ) := cexp (2 * œÄ * Complex.I * z / 24) * ‚àè' (n : ‚Ñï),
                        (1 - cexp (2 * œÄ * Complex.I * (n + 1) * z))

                       def Œî (z : ‚Ñç) :=  cexp (2 * œÄ * Complex.I * z) * ‚àè' (n : ‚Ñï),
                        (1 - cexp (2 * œÄ * Complex.I * (n + 1) * z)) ^ 24

                        lemma Discriminant_S_invariant : (Œî ‚à£[(12 : ‚Ñ§)] ModularGroup.S) = Œî := by ...

                        lemma Delta_eq_E4E6 (z : ‚Ñç) : Œî z = ((E‚ÇÑ z)^3 - (E‚ÇÜ z)^2) / 1728 := by

                        lemma ModularForm.dimension_level_one (k : ‚Ñ§) (hk : 3 ‚â§ k) (hk2 : Even k)  :
                        Module.rank ‚ÑÇ (ModularForm (CongruenceSubgroup.Gamma 1) k) = if 12 ‚à£ (k : ‚Ñ§) - 2 then
                        Nat.floor ((k : ‚Ñö)/ 12) else Nat.floor ((k : ‚Ñö) / 12) + 1 := by
                     </code>
                </section>

              <section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
    <textarea data-template>
        ### <span style="text-transform: none;">The Blueprint for the Magic Function</span>
        - With the theory of modular forms in place, Viazovska's blueprint shows how to build the magic function.
        - It is constructed as $g(x) = C_1 a(x) + C_2 b(x)$.
        - The functions <span style="text-transform: none; color: #000000">$a(x)$</span> and <span style="text-transform: none; color: #000000">$b(x)$</span> are defined by complex contour integrals of certain combinations of modular and quasimodular forms.
        ---
         ### <span style="text-transform: none;">Things I have skipped</span>
        - Theres is lots of work of others, needed for this project that I haven't mentioned.
        ---
         ### <span style="text-transform: none;">Things I have skipped</span>
        When it comes to modular forms, there is work of David Loeffler, showing the "trivial bounds" on the Fourier coefficients of modular forms, i.e. $a_n(f)$ is $O(n^k)$ for $f$ a modular form of weight $k$.
        ---
         ### <span style="text-transform: none;">Things I have skipped</span>
        - Lots of work on Cohn-Elkies bounds, constructing this magic function.
        - Complex analysis. We do need to extend the types of contour integrals to allow unbounded rectangles and some arcs (this is ongoing).
        ---
        ### <span style="text-transform: none;">Where are we up to?</span>
        - You can find the blueprint and follow our progress here:
        <br>
        <a href="https://thefundamentaltheor3m.github.io/Sphere-Packing-Lean/" style="color: #000000;">
        https://thefundamentaltheor3m.github.io/Sphere-Packing-Lean/
        </a>
        <br>
        <br>
        <img src="blueprint.png" alt="Blueprint QR Code" style="display: block; margin-left: auto; margin-right: auto; border-radius: 10px; width: 250px;">
    </textarea>
</section>


                <section data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <h2>Thank you!</h2>
                </section>

            </div>
        </div>

        <script src="dist/reveal.js"></script>
        <script src="plugin/zoom/zoom.js"></script>
        <script src="plugin/notes/notes.js"></script>
        <script src="plugin/search/search.js"></script>
        <script src="plugin/markdown/markdown.js"></script>
        <script src="plugin/highlight/highlight.js"></script>
        <script src="plugin/highlight/lean.min.js"></script>
        <script src="plugin/highlight/lean-goal.js"></script>
        <script src="plugin/math/math.js"></script>
        <script>
            // Also available as an ES module, see:
            // https://revealjs.com/initialization/
            Reveal.initialize({
                controls: true,
                progress: true,
                center: true,
                hash: true,
                margin: 0,

                // Learn about plugins: https://revealjs.com/plugins/
                plugins: [ RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight, RevealMath.KaTeX ],
            });
        </script>

    </body>
</html>